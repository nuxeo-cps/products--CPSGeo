<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html tal:define="mb_dir here/getBaseUrl">
<head>
<title>CPSGeo Map Widget Demo</title>
<link rel="stylesheet" type="text/css" media="all"
        title="CPSDefault styles" href="/cps/default.css" />
<link rel="stylesheet" type="text/css" media="all"
        href="/cps/boxes.css" />
<link rel="stylesheet" tal:attributes="href string:${mb_dir}mapbuilder/lib/skin/default/mapStyle.css" type="text/css">
<script>
    // URL of Mapbuilder configuration file.
    var mbConfigUrl='geo_edit_config.xml';    

    // Work with the "map_selector" form in the body
    function switch_map()
    {
        box = document.forms[0].map;
        modelurl = box.options[box.selectedIndex].value;
        if (modelurl) config.loadModel('mainMap', modelurl);
    }
</script>
<script type="text/javascript" tal:attributes="src string:${mb_dir}mapbuilder/lib/Mapbuilder.js"></script>
</head>
<body onload="mbDoLoad()">

<!-- Map selector form -->
<div style="padding:10px">
Select base map
<form id="map_selector">
    <select name=map onChange="switch_map()">
    <option value=''>--- Choose Map ---</option>
    <div tal:repeat="map here/portal_maps/mapContexts">
    <option tal:attributes="value map/path" tal:content="map/title">TITLE</option>
    </div>
    </select>
</form>
</div>

<table>
    <tr>
        <!-- left hand column -->
        <td valign="top" style="padding:10px">
            <div><div id="locatorMap"/></div>
            <div><div id="legend"/></div>
        </td>
        <!-- right hand column -->
        <td valign="top"> <table width="100%">
                <tr> 
                    <td align="center" valign="top"> <table>
                            <tr> 
                                <td colspan="3"> <div id="mainMapPane"/>
                                    <div id="loading"> 
                                        <p>Loading Program<br/>
                                            <img tal:attributes="src string:{$mb_dir}mapbuilder/lib/skin/default/images/Loading.gif"/> 
                                        </p>
                                    </div>
                                </td>
                            </tr>
                            <tr> 
                                <td align="left"> <div id="mainButtonBar"/></td>
                                <td align="center" id="mapScaleText" />&nbsp;
                                <td align="right" id="cursorTrack" />&nbsp;
                            </tr>
                            <tr>
                              <td colspan="3">
                                <h3>Document Location</h3>
                                <form id="doc_location">
                                WGS84 Coordinates:&nbsp;<span id="docLocation"></span><br/>
                                <input type="submit" name="submit" value="Set Location"/>
                                </form>
                              </td>
                            </tr>

                            <tr>
                              <td colspan="3" align="left" style="border:solid grey 1px;padding:0.5em">
        Mouse over rows in the query results to see documents highlighted in
        the map frame.
        [<a tal:attributes="href string:javascript:config.loadModel('geoRSS', '${here/portal_maps/geoRSSPath}');">refresh results</a>]
                              <div id="eventsListing"></div>
                              </td>
                            </tr>

                        </table>
                    </td>
                </tr>
            </table>
    </tr>
</table>

</body>
</html>

