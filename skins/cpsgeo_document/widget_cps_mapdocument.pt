<tal:block define="ds options/datastructure;
		   map_id ds/map_id;
		   maptool nocall:here/portal_maps;
		   map_context python:maptool.mapContextFor(map_id)
		   ">

<!-- Map selector form -->
<div style="padding:10px">
  <form id="map_selector">
    <select name=map onChange="switch_map()">
      <option value=""
	      i18n:translate="label_cpsgeo_choose_map">
	--- Choose Map ---
      </option>
      <div tal:repeat="map here/portal_maps/mapContexts">
	<tal:block condition="python:map_context['path'] == map['path']">
	  <option tal:attributes="value map/path" selected="1"
		  tal:content="map/title">title
	  </option>
	</tal:block>
	<!--
	<tal:block condition="python:map_context['path'] != map['path']">
	  <option tal:attributes="value map/path"
		  tal:content="map/title">title
	  </option>
	</tal:block>
	-->
      </div>
    </select>
  </form>
<table>
  <tr>
    <td valign="top" style="padding:10px">
      <div><div id="locatorMap"/></div>
      <div><div id="legend"/></div>
    </td>
    <td valign="top">
      <table width="100%">
	<tr>
	  <td align="center" valign="top">
	    <table>
	      <tr>
		<td colspan="3"> <div id="mainMapPane"/>
		<div id="loading">
		  <p>Loading Program <br/>
		    <img tal:attributes="src string:mapbuilder/lib/skin/default/images/Loading.gif" />
		  </p>
		</div>
		</td>
	      </tr>
	      <tr>
		<td align="left"> <div id="mainButtonBar"/></td>
		<td align="center" id="mapScaleText" />
		<td align="right" id="cursorTrack" />
	      </tr>
	      <tr>
		<td colspan="3" align="left">
		  <p>Search for documents. Results are displayed on the map above.</p>
		  <label>Searchable Text: </label>
		  <input id="cpsgeo_search_text" type="text" name="SearchableText" size="12" maxlength="256" value=""/>  <button type="button" onclick="reload_docs();" class="SearchBox">Search</button>
		</td>
	      </tr>
	    </table>
	  </td>
	</tr>
      </table>
    </td>
  </tr>
</table>
</tal:block>
