<tal:block define="ds options/datastructure;
		   map_id ds/map_id;
		   maptool nocall:here/portal_maps;
		   map_context python:maptool.mapContextFor(map_id)
		   ">
  <div align="right">
    <metal:block use-macro="here/cpsgeo_selector/macros/map_selector" />
  </div>
<table>
  <tr>
    <td valign="top" style="padding:10px">
	<metal:block use-macro="here/cpsgeo_maplocator/macros/maplocator" />
	<metal:block use-macro="here/cpsgeo_layers/macros/layers" />
    </td>
    <td valign="top">
      <table width="100%">
	<tr>
	  <td align="center" valign="top">
	    <table>
	      <tr>
		<td colspan="3"> <div id="mainMapPane"/>
		<div id="loading">
		  <p>Loading Program <br/>
		    <img tal:attributes="src string:mapbuilder/lib/skin/default/images/Loading.gif" />
		  </p>
		</div>
		</td>
	      </tr>
	      <tr>
		<td align="left"> <div id="mainButtonBar"/></td>
		<td align="center" id="mapScaleText" />
		<td align="right" id="cursorTrack" />
	      </tr>
	    </table>
	  </td>
	</tr>
      </table>
    </td>
  </tr>
</table>
</tal:block>
