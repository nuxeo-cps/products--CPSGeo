<metal:block use-macro="here/main_template/macros/master">
  <metal:block fill-slot="doctype"><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"></metal:block>
  <metal:block fill-slot="javascript_head_slot"
	       tal:define="base_dir python:utool.getPortalPath() + '/mapbuilder/lib'">
    <tal:block replace="structure string:<script type='text/javascript'>
      var baseDir = '${base_dir}';
      </script>" />
    <script type="text/javascript" src="cps_geo_common.js" 
	    tal:attributes="src string:${here/absolute_url}/cps_geo_common.js"></script>
    <script type="text/javascript"
	    tal:attributes="src string:mapbuilder/lib/Mapbuilder.js" />
  </metal:block>
  <metal:block fill-slot="header">
    <h1 i18n:translate="header_geolocation_browser">
	Browse maps
    </h1>
  </metal:block>
  <metal:block fill-slot="main">
    <div>
      <div align="right">
	<metal:block use-macro="here/cpsgeo_selector/macros/map_selector" />
      </div>
    </div>
    <table>
      <tr>
	<td valign="top" style="padding:10px">
	  <metal:block use-macro="here/cpsgeo_maplocator/macros/maplocator" />
	  <metal:block use-macro="here/cpsgeo_layers/macros/layers" />
	</td>
	<td valign="top"> 
	  <table width="100%">
	    <tr>
	      <td align="center" valign="top"> <table>
		<tr>
		  <td colspan="3"> <div id="mainMapPane"/>
		  <div id="loading">
		    <p i18n:translate="label_cpsgeo_loading_program">
		      Loading Program
		    </p>
		    <br/>
		    <img tal:attributes="src string:${here/absolute_url}/mapbuilder/lib/skin/default/images/Loading.gif"/>
		  </div>
		  </td>
		</tr>
		<tr>
		  <td align="left"> <div id="mainButtonBar"/></td>
		  <td align="center" id="mapScaleText" />&nbsp;
		  <td align="right" id="cursorTrack" />&nbsp;
		</tr>
	      </table>
	      </td>
	    </tr>
	    <tr>
	      <td colspan="3" align="right">
		<div id="manage_map">
		  <h3>
		    <a href="javascript:editMap()" i18n:translate="action_edit_map">
		      Edit this map
		    </a>
		  </h3>
		  <h3>
		    <a href="javascript:addMap()" i18n:translate="action_add_map">
		      Add a new map
		    </a>
		  </h3>
		</div>
	      </td>
	    </tr>
	  </table>
	</td>
      </tr>
    </table>
  </metal:block>
</metal:block>
