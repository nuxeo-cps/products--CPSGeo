<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
<a href='http://mapbuilder.sourceforge.net'>Community Map Builder</a> 10 Aug 2005 Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="Util.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b><a href='http://mapbuilder.sourceforge.net'>Community Map Builder</a> 10 Aug 2005</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>Util.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		No overview generated for 'Util.js'<BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="XslProcessor.html">XslProcessor</a></b></td>
    <td>&nbsp;</td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

	<a name="method_summary"><!-- --></a>
	<table border="1" cellpadding="3" cellspacing="0" width="100%">
		<tr bgcolor="#CCCCFF" class="TableHeadingColor">
			<td colspan=2>
				<font size="+2">
					<b>Method Summary</b>
				</font>
			</td>
		</tr>
	
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;void</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#addEvent">addEvent</a></b>(elementObject, eventName, functionObject)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 attach an event to an element.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;void</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#debug">debug</a></b>(output)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 write debugging info to a textbox onscreen.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getAbsPos">getAbsPos</a></b>(elt,which)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 TBD: Comment me.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getAbsX">getAbsX</a></b>(elt)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 get the absolute position of HTML element NS4, IE4/5 & NS6, even if it's in a table.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getAbsY">getAbsY</a></b>(elt)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 get the absolute position of HTML element NS4, IE4/5 & NS6, even if it's in a table.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getArgs">getArgs</a></b>()
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 parse comma-separated name=value argument pairs from the query string of the URL; the function stores name=value pairs in properties of an object and returns that object.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getGeoCoordX">getGeoCoordX</a></b>(context, xCooord)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 convert screen x coordinate to geographic coordinate.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getGeoCoordY">getGeoCoordY</a></b>(yCoord)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 convert screen coordinate to screen coordinate.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getPageX">getPageX</a></b>(e)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 get the absolute position of a user event (e.g., a mousedown).
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getPageY">getPageY</a></b>(e)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 get the absolute position of a user event (e.g., a mousedown).
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getProxyPlusUrl">getProxyPlusUrl</a></b>(url)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 If URL is local, then return URL unchanged,
 else return URL of http://proxy?url=URL , or null if proxy not defined.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getScreenX">getScreenX</a></b>(context, xCoord)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 convert geographic x coordinate to screen coordinate.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#getScreenY">getScreenY</a></b>(context, yCoord)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 convert geographic y coordinate to screen coordinate.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;void</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#handleEventWithObject">handleEventWithObject</a></b>(evt)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 handle event attached to an object.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#makeElt">makeElt</a></b>(type)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 create an element and append it to the document body element.
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#openPopup">openPopup</a></b>(url, width, height)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 open a popup window, adapted from http://www.quirksmode.org/js/croswin.html
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#postLoad">postLoad</a></b>(sUri, docToSend, contentType )
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 A more flexible interface for loading docs that allows POST and async loading
		      </td>
		   </tr>
		
		   <tr bgcolor="white" class="TableRowColor">
		      <td align="right" valign="top" width="1%">
			 <font size="-1">
			    <code>static&nbsp;Object</code>
			 </font>
		      </td>
		      <td>
			 <code>
			    <b>
			       <a href="GLOBALS.html#returnTarget">returnTarget</a></b>(evt)
			 </code>
			 <br>
			 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			 determine and return the target element of an event.
		      </td>
		   </tr>
		
	
	</table>
    <p>

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/*
License:      LGPL as per: http://www.gnu.org/copyleft/lesser.html
Dependancies: Sarissa

$Id$
*/</span>
<span class="comment">
// some basic browser detection</span>
var MB_IS_MOZ = (document.implementation &amp;&amp; document.implementation.createDocument)?true:false;

<span class="comment">/**
Transform an XML document using the provided XSL and use the results to build
a web page.
<span class="attrib">@constructor</span>
<span class="attrib">@param</span> xslUrl The URL of an XSL stylesheet.
<span class="attrib">@author</span> Cameron Shorter - Cameron AT Shorter.net
*/</span>
<span class="reserved">function</span> XslProcessor(xslUrl,docNSUri) {
<span class="comment">  // get the stylesheet document</span>
  <span class="reserved">this</span>.xslUrl=xslUrl;
  <span class="reserved">this</span>.xslDom = Sarissa.getDomDocument();
  <span class="reserved">this</span>.xslDom.async = false;
  <span class="reserved">this</span>.xslDom.validateOnParse=false;  //IE6 SP2 parsing bug
  <span class="reserved">this</span>.xslDom.load(xslUrl);
  <span class="reserved">if</span> ( <span class="reserved">this</span>.xslDom.parseError &lt; 0 )
    alert(<span class="literal">"error loading XSL stylesheet: "</span> + xslUrl);

  <span class="reserved">this</span>.processor = new XSLTProcessor();
  <span class="reserved">this</span>.processor.importStylesheet(<span class="reserved">this</span>.xslDom);

  <span class="reserved">this</span>.docNSUri = docNSUri;

  <span class="comment">/**
   * Transforms XML in the provided xml node according to this XSL.
   * <span class="attrib">@param</span> xmlNode The XML node to be transformed.
   * <span class="attrib">@return</span> The transformed String.
   */</span>
  <span class="reserved">this</span>.transformNodeToString = <span class="reserved">function</span>(xmlNode) {
    try {
<span class="comment">      // transform and build a web page with result</span>
      var newDoc = <span class="reserved">this</span>.transformNodeToObject(xmlNode);
      var s = Sarissa.serialize(newDoc);
      <span class="reserved">return</span> Sarissa.unescape(s);
    } catch(e){
      alert(<span class="literal">"Exception transforming doc with XSL: "</span> + <span class="reserved">this</span>.xslUrl);
      alert(<span class="literal">"XSL="</span>+Sarissa.serialize(<span class="reserved">this</span>.xslDom));
      alert(<span class="literal">"XML="</span>+Sarissa.serialize(xmlNode));
    }
  }

  <span class="comment">/**
   * Transforms XML in the provided xml node according to this XSL.
   * <span class="attrib">@param</span> xmlNode The XML node to be transformed.
   * <span class="attrib">@return</span> a DOM document object
   */</span>
  <span class="reserved">this</span>.transformNodeToObject=<span class="reserved">function</span>(xmlNode) {
    var newFragment = <span class="reserved">this</span>.processor.transformToDocument(xmlNode);
    <span class="reserved">return</span> newFragment;
  }

  <span class="comment">/**
   * Set XSL parameter.
   */</span>
  <span class="reserved">this</span>.setParameter=<span class="reserved">function</span>(paramName, paramValue, nsUri) {
<span class="comment">    //if ( typeof paramValue == "string" || typeof paramValue == "number") paramValue="'"+paramValue+"'";</span>
    <span class="reserved">this</span>.processor.setParameter( null, paramName, paramValue);
  }
}

<span class="comment">/**
 * A more flexible interface for loading docs that allows POST and async loading
 */</span>
<span class="reserved">function</span> postLoad(sUri, docToSend, contentType ) {
   var outDoc = Sarissa.getDomDocument();
   var xmlHttp = Sarissa.getXmlHttpRequest();
   <span class="reserved">if</span> ( sUri.indexOf(<span class="literal">"http://"</span>)==0 ) {
     xmlHttp.open(<span class="literal">"POST"</span>, config.proxyUrl, false);
     xmlHttp.setRequestHeader(<span class="literal">"serverUrl"</span>,sUri);//escape(sUri).replace(/\+/g, <span class="literal">'%2C'</span>).replace(/\<span class="literal">"/g,'%22').replace(/\'/g, '%27'));
   } else {
     xmlHttp.open("</span>POST<span class="literal">", sUri, false);
   }
   xmlHttp.setRequestHeader("</span>content-type<span class="literal">","</span>text/xml<span class="literal">");
   if (contentType) xmlHttp.setRequestHeader("</span>content-type<span class="literal">",contentType);
   //alert("</span>sending:<span class="literal">"+docToSend.xml);
   xmlHttp.send( docToSend );
/*
   if (_SARISSA_IS_IE) {
alert("</span>before<span class="literal">");
    xmlHttp.status = xmlHttp.Status;
alert("</span>after<span class="literal">");
    xmlHttp.statusText = xmlHttp.StatusText;
    xmlHttp.responseText = xmlHttp.ResponseText;
   }
*/
   if (xmlHttp.status &gt;= 400) {   //http errors status start at 400
      alert("</span>error loading document: <span class="literal">" + sUri + "</span> - <span class="literal">" + xmlHttp.statusText + "</span>-<span class="literal">" + xmlHttp.responseText );
      outDoc.parseError = -1;
      return outDoc;
   } else {
     //alert(xmlHttp.getResponseHeader("</span>Content-Type<span class="literal">"));
     if ( null==xmlHttp.responseXML ) alert( "</span>null XML response:<span class="literal">" + xmlHttp.responseText );

     //copy to Sarissa document from a HttpRequest object
     outDoc.validateOnParse = false;
     outDoc.loadXML(xmlHttp.responseText);
     return outDoc;
   }
}

  /**
   * If URL is local, then return URL unchanged,
   * else return URL of http://proxy?url=URL , or null if proxy not defined.
   * @param url Url of the file to access.
   * @return Url of the proxy and service in the form http://host/proxy?url=service
   */
function getProxyPlusUrl(url) {
  if ( url.indexOf("</span>http://<span class="literal">")==0 ) {
    if ( config.proxyUrl ) {
      url=config.proxyUrl+"</span>?url=<span class="literal">"+escape(url).replace(/\+/g, '%2C').replace(/\"</span>/g,<span class="literal">'%22'</span>).replace(/\<span class="literal">'/g, '</span>%27<span class="literal">');
    } else {
      alert("unable to load external document:"+url+"  Set the proxyUrl property in config.");
      url=null;
    }
  }
  return url;
}

  /**
   * Browser independant version of createElementNS() because creating elements
   * with namespaces other than the defalut namespace isn'</span>t dupported in IE,
   * or at least I can<span class="literal">'t figure out how to do it.  
   * Caution: In IE the new element doesn'</span>t appear to a namespace!!
   * @param doc the owner document <span class="reserved">for</span> the new element
   * @param name the name <span class="reserved">for</span> the new element
   * @param ns the URL <span class="reserved">for</span> the namespace (without a prefix)
   * @<span class="reserved">return</span> element in the document with the specified namespace
   */
<span class="reserved">function</span> createElementWithNS(doc,name,nsUri) {
  <span class="reserved">if</span> (_SARISSA_IS_IE) {
    var newElement = doc.createElement(name);
<span class="comment">    //newElement.namespaceURI = nsUri;  //can't do this for some reason?</span>
    <span class="reserved">return</span> newElement;
  } <span class="reserved">else</span> {
    <span class="reserved">return</span> doc.createElementNS(nsUri,name);
  }
}

<span class="comment">/**
 * Create a unique Id which can be used for classes to link themselves to HTML
 * Ids.
 * <span class="attrib">@constructor</span>
 */</span>
<span class="reserved">function</span> UniqueId(){
  <span class="reserved">this</span>.lastId=0;

  <span class="comment">/** Return a numeric unique Id. */</span>
  <span class="reserved">this</span>.getId=<span class="reserved">function</span>() {
    <span class="reserved">this</span>.lastId++;
    <span class="reserved">return</span> <span class="reserved">this</span>.lastId;
  }
}
<span class="comment">//use this global object to generate a unique ID via the getId function</span>
var mbIds = new UniqueId();

<span class="reserved">function</span> setISODate(isoDateStr) {
  var parts = isoDateStr.match(/(\d{4})-?(\d{2})?-?(\d{2})?T?(\d{2})?:?(\d{2})?:?(\d{2})?\.?(\d{0,3})?(Z)?/);
  var res = null;
  <span class="reserved">for</span> (var i=1;i&lt;parts.length;++i){
    <span class="reserved">if</span> (!parts[i]) {
      parts[i] = (i==3)?1:0; //months start with day number 1, not 0
      <span class="reserved">if</span> (!res) res = i;
    }
  }
  var isoDate = new Date();
  isoDate.setFullYear(parseInt(parts[1],10));
  isoDate.setMonth(parseInt(parts[2]-1,10));
  isoDate.setDate(parseInt(parts[3],10));
  isoDate.setHours(parseInt(parts[4],10));
  isoDate.setMinutes(parseInt(parts[5],10));
  isoDate.setSeconds(parseFloat(parts[6],10));
  <span class="reserved">if</span> (!res) res = 6;
  isoDate.res = res;
  <span class="reserved">return</span> isoDate;
}

<span class="reserved">function</span> getISODate(isoDate) {
  var res = isoDate.res?isoDate.res:6;
  var dateStr = <span class="literal">""</span>;
  dateStr += res&gt;1?isoDate.getFullYear():<span class="literal">""</span>;
  dateStr += res&gt;2?<span class="literal">"-"</span>+leadingZeros(isoDate.getMonth()+1,2):<span class="literal">""</span>;
  dateStr += res&gt;3?<span class="literal">"-"</span>+leadingZeros(isoDate.getDate(),2):<span class="literal">""</span>;
  dateStr += res&gt;4?<span class="literal">"T"</span>+leadingZeros(isoDate.getHours(),2):<span class="literal">""</span>;
  dateStr += res&gt;5?<span class="literal">":"</span>+leadingZeros(isoDate.getMinutes(),2):<span class="literal">""</span>;
  dateStr += res&gt;6?<span class="literal">":"</span>+leadingZeros(isoDate.getSeconds(),2):<span class="literal">""</span>;
  <span class="reserved">return</span> dateStr;
}

<span class="reserved">function</span> leadingZeros(num,digits) {
  var intNum = parseInt(num,10);
  var base = Math.pow(10,digits);
  <span class="reserved">if</span> (intNum&lt;base) intNum += base;
  <span class="reserved">return</span> intNum.toString().substr(1);
}
<span class="comment">

// Correctly handle PNG transparency in Win IE 5.5 or higher.</span>
<span class="comment">// this method should be set as an IMG onload handler for PNG map layers</span>
<span class="comment">// thanks to Caroklyn Cole for this fix.  For an explanation see:</span>
<span class="comment">// http://homepage.ntlworld.com/bobosola. Updated 02-March-2004</span>
<span class="comment">// modified to the images as visible after this has been called.</span>
<span class="reserved">function</span> fixPNG(myImage) {
  <span class="reserved">if</span> (_SARISSA_IS_IE) {
    var imgID = (myImage.id) ? <span class="literal">"id='"</span> + myImage.id + <span class="literal">"' "</span> : <span class="literal">""</span>
    var imgClass = (myImage.className) ? <span class="literal">"class='"</span> + myImage.className + <span class="literal">"' "</span> : <span class="literal">""</span>
    var imgTitle = (myImage.title) ? <span class="literal">"title='"</span> + myImage.title + <span class="literal">"' "</span> : <span class="literal">"title='"</span> + myImage.alt + <span class="literal">"' "</span>
    var imgStyle = <span class="literal">"display:inline-block;"</span> + myImage.style.cssText 
    var strNewHTML = <span class="literal">"&lt;span "</span> + imgID + imgClass + imgTitle
    strNewHTML += <span class="literal">" style=\"</span><span class="literal">" + "</span>width:<span class="literal">" + myImage.width + "</span>px; height:<span class="literal">" + myImage.height + "</span>px;<span class="literal">" + imgStyle + "</span>;<span class="literal">"
    strNewHTML += "</span>filter:progid:DXImageTransform.Microsoft.AlphaImageLoader<span class="literal">"
    strNewHTML += "</span>(src=\<span class="literal">'" + myImage.src + "\'</span>, sizingMethod=<span class="literal">'scale'</span>); visibility:visible\<span class="literal">"&gt;&lt;/span&gt;"</span> 
    myImage.outerHTML = strNewHTML
  }
}



<span class="comment">/**
 * get the absolute position of HTML element NS4, IE4/5 &amp; NS6, even if it's in a table.
 * <span class="attrib">@param</span> element The HTML element.
 * <span class="attrib">@return</span> Top left X position.
 */</span>
<span class="reserved">function</span> getAbsX(elt) {
        <span class="reserved">return</span> (elt.x) ? elt.x : getAbsPos(elt,<span class="literal">"Left"</span>) + 2;
}

<span class="comment">/**
 * get the absolute position of HTML element NS4, IE4/5 &amp; NS6, even if it's in a table.
 * <span class="attrib">@param</span> element The HTML element.
 * <span class="attrib">@return</span> Top left Y position.
 */</span>
<span class="reserved">function</span> getAbsY(elt) {
        <span class="reserved">return</span> (elt.y) ? elt.y : getAbsPos(elt,<span class="literal">"Top"</span>) + 2;
}

<span class="comment">/**
 * TBD: Comment me.
 * <span class="attrib">@param</span> elt TBD
 * <span class="attrib">@param</span> which TBD
 */</span>
<span class="reserved">function</span> getAbsPos(elt,which) {
 iPos = 0;
 <span class="reserved">while</span> (elt != null) {
        iPos += elt[<span class="literal">"offset"</span> + which];
        elt = elt.offsetParent;
 }
 <span class="reserved">return</span> iPos;
}

<span class="comment">/**
 * get the absolute position of a user event (e.g., a mousedown).
 * <span class="attrib">@param</span> e The user event.
 * <span class="attrib">@return</span> Left or top position.
 */</span>
<span class="reserved">function</span> getPageX(e){
  var posx = 0;
  <span class="reserved">if</span> (!e) var e = window.event;
  <span class="reserved">if</span> (e.pageX) {
    posx = e.pageX;
  }
  <span class="reserved">else</span> <span class="reserved">if</span> (e.clientX) {
   posx = e.clientX;
  }
  <span class="reserved">if</span> (document.body &amp;&amp; document.body.scrollLeft){
    posx += document.body.scrollLeft;
  }
  <span class="reserved">else</span> <span class="reserved">if</span> (document.documentElement &amp;&amp; document.documentElement.scrollLeft){
    posx += document.documentElement.scrollLeft;
  }
  <span class="reserved">return</span> posx;
}

<span class="comment">/**
 * get the absolute position of a user event (e.g., a mousedown).
 * <span class="attrib">@param</span> e The user event.
 * <span class="attrib">@return</span> Left or top position.
 */</span>
<span class="reserved">function</span> getPageY(e){
  var posy = 0;
  <span class="reserved">if</span> (!e) var e = window.event;
  <span class="reserved">if</span> (e.pageY) {
    posy = e.pageY;
  }
  <span class="reserved">else</span> <span class="reserved">if</span> (e.clientY) {
    posy = e.clientY;
  }
  <span class="reserved">if</span> (document.body &amp;&amp; document.body.scrollTop){
    posy += document.body.scrollTop;
  }
  <span class="reserved">else</span> <span class="reserved">if</span> (document.documentElement &amp;&amp; document.documentElement.scrollTop){
    posy += document.documentElement.scrollTop;
  }
  <span class="reserved">return</span> posy;
}

<span class="comment">/**
 * parse comma-separated name=value argument pairs from the query string of the URL; the function stores name=value pairs in properties of an object and returns that object. 
 * <span class="attrib">@return</span> args Array of arguments passed to page, in form args[argname] = value.
 */</span>
<span class="reserved">function</span> getArgs(){
  var args = new Object();
  var query = location.search.substring(1);
  var pairs = query.split(<span class="literal">"&amp;"</span>);
  <span class="reserved">for</span>(var i = 0; i &lt; pairs.length; i++) {
    var pos = pairs[i].indexOf(<span class="literal">'='</span>);
    <span class="reserved">if</span> (pos == -1) continue;
    var argname = pairs[i].substring(0,pos);
    var value = pairs[i].substring(pos+1);
    args[argname] = unescape(value.replace(/\+/g, <span class="literal">" "</span>));
  }
  <span class="reserved">return</span> args;
}
<span class="comment">//initialize the array once</span>
window.cgiArgs = getArgs();

<span class="comment">/**
 * convert geographic x coordinate to screen coordinate.
 * <span class="attrib">@param</span> context The context object.
 * <span class="attrib">@param</span> xCoord The geographic x coordinate to be converted.
 * <span class="attrib">@return</span> x the converted x coordinate.
 */</span>
<span class="reserved">function</span> getScreenX(context, xCoord){
  bbox=context.getBoundingBox();
  width=context.getWindowWidth();
  bbox[0]=parseFloat(bbox[0]);
  bbox[2]=parseFloat(bbox[2]);
  var xfac = (width/(bbox[2]-bbox[0]));
  x=xfac*(xCoord-bbox[0]);
  <span class="reserved">return</span> x;
}

<span class="comment">/**
 * convert geographic y coordinate to screen coordinate.
 * <span class="attrib">@param</span> context The context object.
 * <span class="attrib">@param</span> yCoord The geographic x coordinate to be converted.
 * <span class="attrib">@return</span> y the converted x coordinate.
 */</span>
<span class="reserved">function</span> getScreenY(context, yCoord){
  var bbox=context.getBoundingBox();
  var height=context.getWindowHeight();
  bbox[1]=parseFloat(bbox[1]);
  bbox[3]=parseFloat(bbox[3]);
  var yfac = (heighteight/(bbox[3]-bbox[1]));
  var y=height-(yfac*(pt.y-bbox[1]));
  <span class="reserved">return</span> y;
}

<span class="comment">/**
 * convert screen x coordinate to geographic coordinate.
 * <span class="attrib">@param</span> context The context object.
 * <span class="attrib">@param</span> xCoord The screen x coordinate to be converted.
 * <span class="attrib">@return</span> x the converted x coordinate.
 */</span>
<span class="reserved">function</span> getGeoCoordX(context, xCooord) {
  var bbox=context.getBoundingBox();
  var width=context.getWindowWidth();
  bbox[0]=parseFloat(bbox[0]);
  bbox[2]=parseFloat(bbox[2]);
  var xfac = ((bbox[2]-bbox[0]) / width);
  var x=bbox[0] + xfac*(xCoord);
  <span class="reserved">return</span> x;
}

<span class="comment">/**
 * convert screen coordinate to screen coordinate.
 * <span class="attrib">@param</span> context The context object.
 * <span class="attrib">@param</span> yCoord The geographic y coordinate to be converted.
 * <span class="attrib">@return</span> y the converted y coordinate.
 */</span>
<span class="reserved">function</span> getGeoCoordY(yCoord){
  var bbox=context.getBoundingBox();
  var height=context.getWindowHeight();
  bbox[1]=parseFloat(bbox[1]);
  bbox[3]=parseFloat(bbox[3]);
  var yfac = ((bbox[3]-bbox[1]) / height);
  var y=bbox[1] + yfac*(height-yCoord);
  <span class="reserved">return</span> y;
}

<span class="comment">/**
 * create an element and append it to the document body element.
 * <span class="attrib">@param</span> type The type of element to be created.
 * <span class="attrib">@return</span> node The node created and appended.
 */</span>
<span class="reserved">function</span> makeElt(type) {
  var node=document.createElement(type);
  document.getElementsByTagName(<span class="literal">"body"</span>).item(0).appendChild(node);
  <span class="reserved">return</span> node;
}
<span class="comment">
// variable needed to determine if a popup window is currently open</span>
var newWindow = <span class="literal">''</span>;
<span class="comment">/**
 * open a popup window, adapted from http://www.quirksmode.org/js/croswin.html
 * <span class="attrib">@param</span> url The url of the page to be opened.
 * <span class="attrib">@param</span> width Width of the popup window, in pixels.
 * <span class="attrib">@param</span> height Height of the popup window, in pixels.
 */</span>
<span class="reserved">function</span> openPopup(url, width, height) {
  <span class="reserved">if</span>(width == null) {
    width = 300;
  }
  <span class="reserved">if</span>(height == null) {
    height = 200;
  }
  <span class="reserved">if</span> (!newWindow.closed &amp;&amp; newWindow.location) {
    newWindow.location.href = url;
  }
  <span class="reserved">else</span> {
    newWindow=window.open(url,<span class="literal">'name'</span>,<span class="literal">'height='</span> + height + <span class="literal">',width='</span> + width);
    <span class="reserved">if</span> (!newWindow.opener) newwindow.opener = self;
  }
  <span class="reserved">if</span> (window.focus) {newWindow.focus()}
  <span class="reserved">return</span> false;
}

<span class="comment">/**
 * write debugging info to a textbox onscreen.
 * <span class="attrib">@param</span> output String to be output.
 */</span>
<span class="reserved">function</span> debug(output){
  tarea=makeElt(<span class="literal">"textarea"</span>);
  tarea.setAttribute(<span class="literal">"rows"</span>,<span class="literal">"3"</span>);
  tarea.setAttribute(<span class="literal">"cols"</span>,<span class="literal">"40"</span>);
  tnode=document.createTextNode(output);
  tarea.appendChild(tnode);
}

<span class="comment">/**
 * determine and return the target element of an event.
 * <span class="attrib">@param</span> evt The event.
 * <span class="attrib">@return</span> elt The element.
 */</span>
<span class="reserved">function</span> returnTarget(evt){
  evt = (evt) ? evt : ((window.event) ? window.event : <span class="literal">""</span>);
  var elt=null;
  <span class="reserved">if</span>(evt.target){
    elt=evt.target;
  }
  <span class="reserved">else</span> <span class="reserved">if</span>(evt.srcElement){
    elt=evt.srcElement;
  }
  <span class="reserved">return</span> elt;
}

<span class="comment">/**
 * attach an event to an element.
 * <span class="attrib">@param</span> elementObject The object.
 * <span class="attrib">@param</span> eventName The name of the event.
 * <span class="attrib">@param</span> functionObject The function to be called.
 */</span>
<span class="reserved">function</span> addEvent(elementObject, eventName, functionObject) {
  <span class="reserved">if</span>(document.addEventListener) {
    elementObject.addEventListener(eventName, functionObject, false);
  }
  <span class="reserved">else</span> <span class="reserved">if</span>(document.attachEvent) {
    elementObject.attachEvent(<span class="literal">"on"</span> + eventName, functionObject);
  }
}

<span class="comment">/**
 * handle event attached to an object.
 * <span class="attrib">@param</span> evt The event.
 */</span>
<span class="reserved">function</span> handleEventWithObject(evt){
  var elt = returnTarget(evt);
  var obj = elt.ownerObj;
  <span class="reserved">if</span> (obj!=null) obj.handleEvent(evt);
}

</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b><a href='http://mapbuilder.sourceforge.net'>Community Map Builder</a> 10 Aug 2005</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Wed Aug 10 14:31:26 2005</div>
</body>
</html>
